import"./modulepreload-polyfill-3cfb730f.js";function oe(e,t,n){n=n||{};var r=e.ownerDocument,i=r.defaultView.CustomEvent;typeof i=="function"?i=new i(t,{detail:n}):(i=r.createEvent("Event"),i.initEvent(t,!1,!1),i.detail=n),e.dispatchEvent(i)}function gt(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function vt(e){return e===(e|0)+""}function C(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}const tn=Symbol.prototype.toString;function D(e){return tn.call(e)}const{getOwnPropertySymbols:nn,prototype:{hasOwnProperty:rn}}=Object,{toStringTag:on}=Symbol,Et={},G=nn;function me(e,t){return rn.call(e,t)}function $e(e){return e[on]||e.constructor&&e.constructor.name||"Object"}function v(e,t){try{const n=e[t];return n&&n.constructor,n}catch{return Et}}const sn=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function Ct(e){try{let t=sn.filter(({symbol:o})=>e[o]===!0);if(!t.length)return;const n=t.find(o=>!o.modifier),r=n.name==="Map"&&t.find(o=>o.modifier&&o.prefix),i=t.some(o=>o.arrayish),s=t.some(o=>o.setish);return{name:`${r?r.name:""}${n.name}`,symbols:t,arrayish:i&&!s,setish:s}}catch{return null}}const{getPrototypeOf:je,getOwnPropertyDescriptors:an}=Object,Tt=je({});function xt(e,t,n,r){let i=gt(e),s,o,a,u;e instanceof Map?e instanceof e.constructor?(s=`Map(${e.size})`,o=cn):(s="Map()",o=z):e instanceof Set?e instanceof e.constructor?(s=`Set(${e.size})`,o=ln):(s="Set()",o=z):i?(s=`${e.constructor.name}(${e.length})`,o=fn):(u=Ct(e))?(s=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,i=u.arrayish,o=u.arrayish?dn:u.setish?un:mn):r?(s=$e(e),o=pn):(s=$e(e),o=z);const c=document.createElement("span");c.className="observablehq--expanded",n&&c.appendChild(C(n));const f=c.appendChild(document.createElement("a"));f.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,f.appendChild(document.createTextNode(`${s}${i?" [":" {"}`)),f.addEventListener("mouseup",function(l){l.stopPropagation(),ae(c,De(e,null,n,r))}),o=o(e);for(let l=0;!(a=o.next()).done&&l<20;++l)c.appendChild(a.value);if(!a.done){const l=c.appendChild(document.createElement("a"));l.className="observablehq--field",l.style.display="block",l.appendChild(document.createTextNode("  … more")),l.addEventListener("mouseup",function(d){d.stopPropagation(),c.insertBefore(a.value,c.lastChild.previousSibling);for(let p=0;!(a=o.next()).done&&p<19;++p)c.insertBefore(a.value,c.lastChild.previousSibling);a.done&&c.removeChild(c.lastChild.previousSibling),oe(c,"load")})}return c.appendChild(document.createTextNode(i?"]":"}")),c}function*cn(e){for(const[t,n]of e)yield hn(t,n);yield*z(e)}function*ln(e){for(const t of e)yield At(t);yield*z(e)}function*un(e){for(const t of e)yield At(t)}function*fn(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield A(t,v(e,t),"observablehq--index"));for(const t in e)!vt(t)&&me(e,t)&&(yield A(t,v(e,t),"observablehq--key"));for(const t of G(e))yield A(D(t),v(e,t),"observablehq--symbol")}function*dn(e){let t=0;for(const n=e.size;t<n;++t)yield A(t,e.get(t),!0)}function*pn(e){for(const n in an(e))yield A(n,v(e,n),"observablehq--key");for(const n of G(e))yield A(D(n),v(e,n),"observablehq--symbol");const t=je(e);t&&t!==Tt&&(yield Nt(t))}function*z(e){for(const n in e)me(e,n)&&(yield A(n,v(e,n),"observablehq--key"));for(const n of G(e))yield A(D(n),v(e,n),"observablehq--symbol");const t=je(e);t&&t!==Tt&&(yield Nt(t))}function*mn(e){for(const[t,n]of e)yield A(t,n,"observablehq--key")}function Nt(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(g(e,void 0,void 0,void 0,!0)),t}function A(e,t,n){const r=document.createElement("div"),i=r.appendChild(document.createElement("span"));return r.className="observablehq--field",i.className=n,i.textContent=`  ${e}`,r.appendChild(document.createTextNode(": ")),r.appendChild(g(t)),r}function hn(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(g(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(g(t)),n}function At(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(g(e)),t}function Qe(e){const t=window.getSelection();return t.type==="Range"&&(t.containsNode(e,!0)||t.anchorNode.isSelfOrDescendant(e)||t.focusNode.isSelfOrDescendant(e))}function De(e,t,n,r){let i=gt(e),s,o,a,u;if(e instanceof Map?e instanceof e.constructor?(s=`Map(${e.size})`,o=bn):(s="Map()",o=W):e instanceof Set?e instanceof e.constructor?(s=`Set(${e.size})`,o=wn):(s="Set()",o=W):i?(s=`${e.constructor.name}(${e.length})`,o=gn):(u=Ct(e))?(s=`Immutable.${u.name}${u.name==="Record"?"":`(${e.size})`}`,i=u.arrayish,o=u.arrayish?_n:u.setish?yn:vn):(s=$e(e),o=W),t){const l=document.createElement("span");return l.className="observablehq--shallow",n&&l.appendChild(C(n)),l.appendChild(document.createTextNode(s)),l.addEventListener("mouseup",function(d){Qe(l)||(d.stopPropagation(),ae(l,De(e)))}),l}const c=document.createElement("span");c.className="observablehq--collapsed",n&&c.appendChild(C(n));const f=c.appendChild(document.createElement("a"));f.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,f.appendChild(document.createTextNode(`${s}${i?" [":" {"}`)),c.addEventListener("mouseup",function(l){Qe(c)||(l.stopPropagation(),ae(c,xt(e,null,n,r)))},!0),o=o(e);for(let l=0;!(a=o.next()).done&&l<20;++l)l>0&&c.appendChild(document.createTextNode(", ")),c.appendChild(a.value);return a.done||c.appendChild(document.createTextNode(", …")),c.appendChild(document.createTextNode(i?"]":"}")),c}function*bn(e){for(const[t,n]of e)yield En(t,n);yield*W(e)}function*wn(e){for(const t of e)yield g(t,!0);yield*W(e)}function*yn(e){for(const t of e)yield g(t,!0)}function*_n(e){let t=-1,n=0;for(const r=e.size;n<r;++n)n>t+1&&(yield se(n-t-1)),yield g(e.get(n),!0),t=n;n>t+1&&(yield se(n-t-1))}function*gn(e){let t=-1,n=0;for(const r=e.length;n<r;++n)n in e&&(n>t+1&&(yield se(n-t-1)),yield g(v(e,n),!0),t=n);n>t+1&&(yield se(n-t-1));for(const r in e)!vt(r)&&me(e,r)&&(yield Y(r,v(e,r),"observablehq--key"));for(const r of G(e))yield Y(D(r),v(e,r),"observablehq--symbol")}function*W(e){for(const t in e)me(e,t)&&(yield Y(t,v(e,t),"observablehq--key"));for(const t of G(e))yield Y(D(t),v(e,t),"observablehq--symbol")}function*vn(e){for(const[t,n]of e)yield Y(t,n,"observablehq--key")}function se(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=e===1?"empty":`empty × ${e}`,t}function Y(e,t,n){const r=document.createDocumentFragment(),i=r.appendChild(document.createElement("span"));return i.className=n,i.textContent=e,r.appendChild(document.createTextNode(": ")),r.appendChild(g(t,!0)),r}function En(e,t){const n=document.createDocumentFragment();return n.appendChild(g(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(g(t,!0)),n}function Cn(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${Tn(e.getUTCFullYear())}-${N(e.getUTCMonth()+1,2)}-${N(e.getUTCDate(),2)}${n||r||i||s?`T${N(n,2)}:${N(r,2)}${i||s?`:${N(i,2)}${s?`.${N(s,3)}`:""}`:""}Z`:""}`}function Tn(e){return e<0?`-${N(-e,6)}`:e>9999?`+${N(e,6)}`:N(e,4)}function N(e,t){return`${e}`.padStart(t,"0")}function xn(e){return Cn(e,"Invalid Date")}var Nn=Error.prototype.toString;function An(e){return e.stack||Nn.call(e)}var Sn=RegExp.prototype.toString;function $n(e){return Sn.call(e)}const _e=20;function On(e,t,n,r){if(t===!1){if(Ke(e,/["\n]/g)<=Ke(e,/`|\${/g)){const c=document.createElement("span");r&&c.appendChild(C(r));const f=c.appendChild(document.createElement("span"));return f.className="observablehq--string",f.textContent=JSON.stringify(e),c}const o=e.split(`
`);if(o.length>_e&&!n){const c=document.createElement("div");r&&c.appendChild(C(r));const f=c.appendChild(document.createElement("span"));f.className="observablehq--string",f.textContent="`"+Je(o.slice(0,_e).join(`
`));const l=c.appendChild(document.createElement("span")),d=o.length-_e;return l.textContent=`Show ${d} truncated line${d>1?"s":""}`,l.className="observablehq--string-expand",l.addEventListener("mouseup",function(p){p.stopPropagation(),ae(c,g(e,t,!0,r))}),c}const a=document.createElement("span");r&&a.appendChild(C(r));const u=a.appendChild(document.createElement("span"));return u.className=`observablehq--string${n?" observablehq--expanded":""}`,u.textContent="`"+Je(e)+"`",a}const i=document.createElement("span");r&&i.appendChild(C(r));const s=i.appendChild(document.createElement("span"));return s.className="observablehq--string",s.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}…${e.slice(-49)}`:e),i}function Je(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,qn)}function qn(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}function Ke(e,t){for(var n=0;t.exec(e);)++n;return n}var kn=Function.prototype.toString,Ln={prefix:"async ƒ"},In={prefix:"async ƒ*"},Xe={prefix:"class"},Rn={prefix:"ƒ"},Mn={prefix:"ƒ*"};function Pn(e,t){var n,r,i=kn.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=Ln;break;case"AsyncGeneratorFunction":n=In;break;case"GeneratorFunction":n=Mn;break;default:n=/^class\b/.test(i)?Xe:Rn;break}return n===Xe?B(n,"",t):(r=/^(?:async\s*)?(\w+)\s*=>/.exec(i))?B(n,"("+r[1]+")",t):(r=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(i))?B(n,r[1]?"("+r[1].replace(/\s*,\s*/g,", ")+")":"()",t):(r=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(i))?B(n,r[1]?"("+r[1].replace(/\s*,\s*/g,", ")+")":"()",t):B(n,"(…)",t)}function B(e,t,n){var r=document.createElement("span");r.className="observablehq--function",n&&r.appendChild(C(n));var i=r.appendChild(document.createElement("span"));return i.className="observablehq--keyword",i.textContent=e.prefix,r.appendChild(document.createTextNode(t)),r}const{prototype:{toString:jn}}=Object;function g(e,t,n,r,i){let s=typeof e;switch(s){case"boolean":case"undefined":{e+="";break}case"number":{e=e===0&&1/e<0?"-0":e+"";break}case"bigint":{e=e+"n";break}case"symbol":{e=D(e);break}case"function":return Pn(e,r);case"string":return On(e,t,n,r);default:{if(e===null){s=null,e="null";break}if(e instanceof Date){s="date",e=xn(e);break}if(e===Et){s="forbidden",e="[forbidden]";break}switch(jn.call(e)){case"[object RegExp]":{s="regexp",e=$n(e);break}case"[object Error]":case"[object DOMException]":{s="error",e=An(e);break}default:return(n?xt:De)(e,t,r,i)}break}}const o=document.createElement("span");r&&o.appendChild(C(r));const a=o.appendChild(document.createElement("span"));return a.className=`observablehq--${s}`,a.textContent=e,o}function ae(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),oe(t,"load")}const Dn=/\s+\(\d+:\d+\)$/m;class Oe{constructor(t){if(!t)throw new Error("invalid node");this._node=t,t.classList.add("observablehq")}pending(){const{_node:t}=this;t.classList.remove("observablehq--error"),t.classList.add("observablehq--running")}fulfilled(t,n){const{_node:r}=this;if((!Un(t)||t.parentNode&&t.parentNode!==r)&&(t=g(t,!1,r.firstChild&&r.firstChild.classList&&r.firstChild.classList.contains("observablehq--expanded"),n),t.classList.add("observablehq--inspect")),r.classList.remove("observablehq--running","observablehq--error"),r.firstChild!==t)if(r.firstChild){for(;r.lastChild!==r.firstChild;)r.removeChild(r.lastChild);r.replaceChild(t,r.firstChild)}else r.appendChild(t);oe(r,"update")}rejected(t,n){const{_node:r}=this;for(r.classList.remove("observablehq--running"),r.classList.add("observablehq--error");r.lastChild;)r.removeChild(r.lastChild);var i=document.createElement("div");i.className="observablehq--inspect",n&&i.appendChild(C(n)),i.appendChild(document.createTextNode((t+"").replace(Dn,""))),r.appendChild(i),oe(r,"error",{error:t})}}Oe.into=function(e){if(typeof e=="string"&&(e=document.querySelector(e),e==null))throw new Error("container not found");return function(){return new Oe(e.appendChild(document.createElement("div")))}};function Un(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}const Bn="modulepreload",Fn=function(e,t){return new URL(e,t).href},et={},ce=function(t,n,r){if(!n||n.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Fn(s,r),s in et)return;et[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let f=i.length-1;f>=0;f--){const l=i[f];if(l.href===s&&(!o||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Bn,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((f,l)=>{c.addEventListener("load",f),c.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};var tt={},ge={},ve=34,F=10,Ee=13;function St(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Vn(e,t){var n=St(e);return function(r,i){return t(n(r),i,e)}}function nt(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function _(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function zn(e){return e<0?"-"+_(-e,6):e>9999?"+"+_(e,6):_(e,4)}function Wn(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":zn(e.getUTCFullYear())+"-"+_(e.getUTCMonth()+1,2)+"-"+_(e.getUTCDate(),2)+(i?"T"+_(t,2)+":"+_(n,2)+":"+_(r,2)+"."+_(i,3)+"Z":r?"T"+_(t,2)+":"+_(n,2)+":"+_(r,2)+"Z":n||t?"T"+_(t,2)+":"+_(n,2)+"Z":"")}function $t(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(l,d){var p,h,m=i(l,function(E,T){if(p)return p(E,T-1);h=E,p=d?Vn(E,d):St(E)});return m.columns=h||[],m}function i(l,d){var p=[],h=l.length,m=0,E=0,T,ye=h<=0,R=!1;l.charCodeAt(h-1)===F&&--h,l.charCodeAt(h-1)===Ee&&--h;function Ze(){if(ye)return ge;if(R)return R=!1,tt;var ee,te=m,U;if(l.charCodeAt(te)===ve){for(;m++<h&&l.charCodeAt(m)!==ve||l.charCodeAt(++m)===ve;);return(ee=m)>=h?ye=!0:(U=l.charCodeAt(m++))===F?R=!0:U===Ee&&(R=!0,l.charCodeAt(m)===F&&++m),l.slice(te+1,ee-1).replace(/""/g,'"')}for(;m<h;){if((U=l.charCodeAt(ee=m++))===F)R=!0;else if(U===Ee)R=!0,l.charCodeAt(m)===F&&++m;else if(U!==n)continue;return l.slice(te,ee)}return ye=!0,l.slice(te,h)}for(;(T=Ze())!==ge;){for(var X=[];T!==tt&&T!==ge;)X.push(T),T=Ze();d&&(X=d(X,E++))==null||p.push(X)}return p}function s(l,d){return l.map(function(p){return d.map(function(h){return f(p[h])}).join(e)})}function o(l,d){return d==null&&(d=nt(l)),[d.map(f).join(e)].concat(s(l,d)).join(`
`)}function a(l,d){return d==null&&(d=nt(l)),s(l,d).join(`
`)}function u(l){return l.map(c).join(`
`)}function c(l){return l.map(f).join(e)}function f(l){return l==null?"":l instanceof Date?Wn(l):t.test(l+="")?'"'+l.replace(/"/g,'""')+'"':l}return{parse:r,parseRows:i,format:o,formatBody:a,formatRows:u,formatRow:c,formatValue:f}}var Ot=$t(","),Yn=Ot.parse,Hn=Ot.parseRows,qt=$t("	"),Gn=qt.parse,Zn=qt.parseRows;function Qn(e){for(var t in e){var n=e[t].trim(),r,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))Jn&&i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const Jn=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function w(e,t,n){return{resolve(r=n){return`${e}@${t}/${r}`}}}const Kn=w("d3","7.8.5","dist/d3.min.js"),Xn=w("@observablehq/inputs","0.10.5","dist/inputs.min.js"),er=w("@observablehq/plot","0.6.9","dist/plot.umd.min.js"),tr=w("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),Ce=w("@observablehq/highlight.js","2.0.0","highlight.min.js"),rt=w("@observablehq/katex","0.11.1","dist/katex.min.js"),nr=w("lodash","4.17.21","lodash.min.js"),rr=w("htl","0.3.1","dist/htl.min.js"),ir=w("jszip","3.10.1","dist/jszip.min.js"),or=w("marked","0.3.12","marked.min.js"),it=w("sql.js","1.8.0","dist/sql-wasm.js"),sr=w("vega","5.22.1","build/vega.min.js"),ar=w("vega-lite","5.6.0","build/vega-lite.min.js"),cr=w("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),qe=w("apache-arrow","4.0.1","Arrow.es2015.min.js"),lr=w("apache-arrow","9.0.0","+esm"),kt=w("apache-arrow","11.0.0","+esm"),ur=w("arquero","4.8.8","dist/arquero.min.js"),fr=w("topojson-client","3.1.0","dist/topojson-client.min.js"),dr=w("exceljs","4.3.0","dist/exceljs.min.js"),pr=w("mermaid","9.2.2","dist/mermaid.min.js"),ot=w("leaflet","1.9.3","dist/leaflet.js"),V=w("@duckdb/duckdb-wasm","1.24.0","+esm"),ne=new Map,Z=[],ke=Z.map,mr=Z.some,hr=Z.hasOwnProperty,br=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,wr=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,st=/(?:\.[^/]*|\/)$/;class j extends Error{constructor(t){super(t)}}j.prototype.name=j.name;function at(e){const t=br.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function Lt(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(i){for(const s of t){let o=i[s];if(typeof o=="string")return o.startsWith("./")&&(o=o.slice(2)),st.test(o)?o:`${o}.js`}}function r(i){const s=`${e}${i.name}${i.version?`@${i.version}`:""}/package.json`;let o=ne.get(s);return o||ne.set(s,o=fetch(s).then(a=>{if(!a.ok)throw new j("unable to load package.json");return a.redirected&&!ne.has(a.url)&&ne.set(a.url,o),a.json()})),o}return async function(s,o){if(s.startsWith(e)&&(s=s.substring(e.length)),/^(\w+:)|\/\//i.test(s))return s;if(/^[.]{0,2}\//i.test(s))return new URL(s,o??location).href;if(!s.length||/^[\s._]/.test(s)||/\s$/.test(s))throw new j("illegal name");const a=at(s);if(!a)return`${e}${s}`;if(!a.version&&o!=null&&o.startsWith(e)){const c=await r(at(o.substring(e.length)));a.version=c.dependencies&&c.dependencies[a.name]||c.peerDependencies&&c.peerDependencies[a.name]}if(a.path&&!st.test(a.path)&&(a.path+=".js"),a.path&&a.version&&wr.test(a.version))return`${e}${a.name}@${a.version}/${a.path}`;const u=await r(a);return`${e}${u.name}@${u.version}/${a.path||n(u)||"index.js"}`}}var yr=he(Lt());function he(e){const t=new Map,n=i(null);function r(a){if(typeof a!="string")return a;let u=t.get(a);return u||t.set(a,u=new Promise((c,f)=>{const l=document.createElement("script");l.onload=()=>{try{c(Z.pop()(i(a)))}catch{f(new j("invalid module"))}l.remove()},l.onerror=()=>{f(new j("unable to load module")),l.remove()},l.async=!0,l.src=a,window.define=It,document.head.appendChild(l)})),u}function i(a){return u=>Promise.resolve(e(u,a)).then(r)}function s(a){return he((u,c)=>u in a&&(u=a[u],c=null,typeof u!="string")?u:e(u,c))}function o(a){return arguments.length>1?Promise.all(ke.call(arguments,n)).then(_r):n(a)}return o.alias=s,o.resolve=e,o}function _r(e){const t={};for(const n of e)for(const r in n)hr.call(n,r)&&(n[r]==null?Object.defineProperty(t,r,{get:gr(n,r)}):t[r]=n[r]);return t}function gr(e,t){return()=>e[t]}function vr(e){return e=e+"",e==="exports"||e==="module"}function It(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t=typeof e=="string"?[]:e),Z.push(mr.call(t,vr)?i=>{const s={},o={exports:s};return Promise.all(ke.call(t,a=>(a=a+"",a==="exports"?s:a==="module"?o:i(a)))).then(a=>(n.apply(null,a),o.exports))}:i=>Promise.all(ke.call(t,i)).then(s=>typeof n=="function"?n.apply(null,s):n))}It.amd={};const k="https://cdn.observableusercontent.com/npm/";let L=yr;function Er(e){L=e}function Cr(e){return e==null?L:he(e)}async function Rt(e){const[t,n]=await Promise.all([e(it.resolve()),e.resolve(it.resolve("dist/"))]);return t({locateFile:r=>`${n}${r}`})}class Q{constructor(t){Object.defineProperties(this,{_db:{value:t}})}static async open(t){const[n,r]=await Promise.all([Rt(L),Promise.resolve(t).then(Le)]);return new Q(new n.Database(r))}async query(t,n){return await xr(this._db,t,n)}async queryRow(t,n){return(await this.query(t,n))[0]||null}async explain(t,n){const r=await this.query(`EXPLAIN QUERY PLAN ${t}`,n);return q("pre",{className:"observablehq--inspect"},[Te(r.map(i=>i.detail).join(`
`))])}async describeTables({schema:t}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${t==null?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,t==null?[]:[t])}async describeColumns({schema:t,table:n}={}){if(n==null)throw new Error("missing table");const r=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${t==null?"":", ?"}) ORDER BY cid`,t==null?[n]:[n,t]);if(!r.length)throw new Error(`table not found: ${n}`);return r.map(({name:i,type:s,notnull:o})=>({name:i,type:Tr(s),databaseType:s,nullable:!o}))}async describe(t){const n=await(t===void 0?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[t]));if(!n.length)throw new Error("Not found");const{columns:r}=n;return q("table",{value:n},[q("thead",[q("tr",r.map(i=>q("th",[Te(i)])))]),q("tbody",n.map(i=>q("tr",r.map(s=>q("td",[Te(i[s])])))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(t,...n){return[t.join("?"),n]}}Object.defineProperty(Q.prototype,"dialect",{value:"sqlite"});function Tr(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";case"DATE":case"DATETIME":return"string";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function Le(e){return typeof e=="string"?fetch(e).then(Le):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(Le):e instanceof ArrayBuffer?new Uint8Array(e):e}async function xr(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:i,values:s}=r,o=s.map(a=>Object.fromEntries(a.map((u,c)=>[i[c],u])));return o.columns=i,o}function q(e,t,n){arguments.length===2&&(n=t,t=void 0);const r=document.createElement(e);if(t!==void 0)for(const i in t)r[i]=t[i];if(n!==void 0)for(const i of n)r.appendChild(i);return r}function Te(e){return document.createTextNode(e)}function xe(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Nr(e,t=xe){let n,r=!1;if(t.length===1){let i;for(const s of e){const o=t(s);(r?xe(o,i)>0:xe(o,o)===0)&&(n=s,i=o,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function Ar(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function Ue(e){return e&&typeof e.toArrowBuffer=="function"}function le(e){return e&&typeof e.getChild=="function"&&typeof e.toArray=="function"&&e.schema&&Array.isArray(e.schema.fields)}function Sr(e){return e.schema.fields.map($r)}function $r(e){return{name:e.name,type:Or(e.type),nullable:e.nullable,databaseType:String(e.type)}}function Or(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";case 11:case 17:default:return"other"}}async function Be(){return await ce(()=>import(`${k}${kt.resolve()}`),[],import.meta.url)}let Ne;class J{constructor(t){Object.defineProperties(this,{_db:{value:t}})}async queryStream(t,n){const r=await this._db.connect();let i,s;try{if((n==null?void 0:n.length)>0?i=await(await r.prepare(t)).send(...n):i=await r.send(t),s=await i.next(),s.done)throw new Error("missing first batch")}catch(o){throw await r.close(),o}return{schema:Sr(s.value),async*readRows(){try{for(;!s.done;)yield s.value.toArray(),s=await i.next()}finally{await r.close()}}}}async query(t,n){const r=await this.queryStream(t,n),i=[];for await(const s of r.readRows())for(const o of s)i.push(o);return i.schema=r.schema,i}async queryRow(t,n){const i=(await this.queryStream(t,n)).readRows();try{const{done:s,value:o}=await i.next();return s||!o.length?null:o[0]}finally{await i.return()}}async sql(t,...n){return await this.query(t.join("?"),n)}queryTag(t,...n){return[t.join("?"),n]}escape(t){return`"${t}"`}async describeTables(){return(await this.query("SHOW TABLES")).map(({name:n})=>({name:n}))}async describeColumns({table:t}={}){return(await this.query(`DESCRIBE ${this.escape(t)}`)).map(({column_name:r,column_type:i,null:s})=>({name:r,type:Rr(i),nullable:s!=="NO",databaseType:i}))}static async of(t={},n={}){var i,s;const r=await Ir();return((i=n.query)==null?void 0:i.castTimestampToDate)===void 0&&(n={...n,query:{...n.query,castTimestampToDate:!0}}),((s=n.query)==null?void 0:s.castBigIntToDouble)===void 0&&(n={...n,query:{...n.query,castBigIntToDouble:!0}}),await r.open(n),await Promise.all(Object.entries(t).map(async([o,a])=>{if(a instanceof y)await ct(r,o,a);else if(le(a))await ue(r,o,a);else if(Array.isArray(a))await lt(r,o,a);else if(Ue(a))await kr(r,o,a);else if("data"in a){const{data:u,...c}=a;le(u)?await ue(r,o,u,c):await lt(r,o,u,c)}else if("file"in a){const{file:u,...c}=a;await ct(r,o,u,c)}else throw new Error(`invalid source: ${a}`)})),new J(r)}}Object.defineProperty(J.prototype,"dialect",{value:"duckdb"});async function ct(e,t,n,r){const i=await n.url();if(i.startsWith("blob:")){const o=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(o))}else await e.registerFileURL(n.name,i,4);const s=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await s.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch(async o=>{if(o.toString().includes("Could not convert"))return await qr(s,n,t);throw o});case"application/json":return await s.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const o=new Uint8Array(await n.arrayBuffer());return await s.insertArrowFromIPCStream(o,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await s.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await s.close()}}async function qr(e,t,n){return await(await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`)).send(t.name)}async function ue(e,t,n,r){const i=await e.connect();try{await i.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await i.close()}}async function kr(e,t,n){const i=(await Be()).tableFromIPC(n.toArrowBuffer());return await ue(e,t,i)}async function lt(e,t,n,r){const s=(await Be()).tableFromJSON(n);return await ue(e,t,s,r)}async function Lr(){const e=await ce(()=>import(`${k}${V.resolve()}`),[],import.meta.url),t=await e.selectBundle({mvp:{mainModule:`${k}${V.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${k}${V.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${k}${V.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${k}${V.resolve("dist/duckdb-browser-eh.worker.js")}`}}),n=new e.ConsoleLogger;return{module:e,bundle:t,logger:n}}async function Ir(){Ne===void 0&&(Ne=Lr());const{module:e,bundle:t,logger:n}=await Ne,r=await e.createWorker(t.mainWorker),i=new e.AsyncDuckDB(n,r);return await i.instantiate(t.mainModule),i}function Rr(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}const Fe=20;function Mr(e,t){return e&&(typeof e.sql=="function"||typeof e.queryTag=="function"&&(typeof e.query=="function"||typeof e.queryStream=="function"))&&(t!=="table"||typeof e.describeColumns=="function")&&e!==Ft}function be(e){return Array.isArray(e)&&(Mt(e.schema)||Pt(e.columns)||Pr(e)||Dt(e)||Ut(e))||Bt(e)}function Pr(e){const t=Math.min(Fe,e.length);for(let n=0;n<t;++n){const r=e[n];if(r===null||typeof r!="object")return!1}return t>0&&jr(e[0])}function jr(e){for(const t in e)return!0;return!1}function Mt(e){return Array.isArray(e)&&e.every(Dr)}function Pt(e){return Array.isArray(e)&&e.every(t=>typeof t=="string")}function Dr(e){return e&&typeof e.name=="string"&&typeof e.type=="string"}function jt(e){return Bt(e)||Dt(e)||Ut(e)}function Dt(e){const t=Math.min(Fe,e.length);if(!(t>0))return!1;let n,r=!1;for(let i=0;i<t;++i){const s=e[i];if(s==null)continue;const o=typeof s;if(n===void 0)switch(o){case"number":case"boolean":case"string":case"bigint":n=o;break;default:return!1}else if(o!==n)return!1;r=!0}return r}function Ut(e){const t=Math.min(Fe,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const i=e[r];if(i!=null){if(!(i instanceof Date))return!1;n=!0}}return n}function Bt(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}const Ft=Object.assign(async(e,t,n,r)=>{if(e=await Ur(await e,r),Mr(e))return ut(e,Wr(t,e),n);if(be(e))return ui(e,t);throw e?new Error("invalid data source"):new Error("missing data source")},{sql(e,t,n){return async function(){return ut(await Br(await e,n),arguments,t)}}});function Vt(e){const t=new WeakMap;return(n,r)=>{if(!n||typeof n!="object")throw new Error("invalid data source");let i=t.get(n);return(!i||be(n)&&n.length!==i._numRows)&&(i=e(n,r),i._numRows=n.length,t.set(n,i)),i}}const Ur=Vt(async(e,t)=>{if(e instanceof y){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return P(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return le(e)||Ue(e)?P(e,t):be(e)&&jt(e)?Array.from(e,n=>({value:n})):e}),Br=Vt(async(e,t)=>{if(e instanceof y){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return P(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return P(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return be(e)?P(await Fr(e,t),t):le(e)||Ue(e)?P(e,t):e});async function Fr(e,t){const n=await Be();return jt(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}function P(e,t=e instanceof y?Vr(e):"__table"){return J.of({[t]:e})}function Vr(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}async function ut(e,t,n){if(!e)throw new Error("missing data source");if(typeof e.queryTag=="function"){const r=new AbortController,i={signal:r.signal};if(n.then(()=>r.abort("invalidated")),typeof e.queryStream=="function")return zr(e.queryStream(...e.queryTag.apply(e,t),i));if(typeof e.query=="function")return e.query(...e.queryTag.apply(e,t),i)}if(typeof e.sql=="function")return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}async function*zr(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const i of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const s of i)r.push(s)}r.done=!0,yield r}catch(i){r.error=i,yield r}}function Wr(e,t){var l;const n=typeof t.escape=="function"?t.escape:d=>d,{select:r,from:i,filter:s,sort:o,slice:a}=e;if(!i.table)throw new Error("missing from table");if(r.columns&&r.columns.length===0)throw new Error("at least one column must be selected");const u=new Map((l=e.names)==null?void 0:l.map(({column:d,name:p})=>[d,p])),f=[[`SELECT ${r.columns?r.columns.map(d=>{const p=u.get(d);return p?`${n(d)} AS ${n(p)}`:n(d)}).join(", "):"*"} FROM ${Yr(i.table,n)}`]];for(let d=0;d<s.length;++d)b(d?`
AND `:`
WHERE `,f),Hr(s[d],f,n);for(let d=0;d<o.length;++d)b(d?", ":`
ORDER BY `,f),ft(o[d],f,n);if(t.dialect==="mssql"||t.dialect==="oracle"){if(a.to!==null||a.from!==null){if(!o.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");b(`
ORDER BY `,f),ft({column:r.columns[0],direction:"ASC"},f,n)}b(`
OFFSET ${a.from||0} ROWS`,f),b(`
FETCH NEXT ${a.to!==null?a.to-(a.from||0):1e9} ROWS ONLY`,f)}}else(a.to!==null||a.from!==null)&&b(`
LIMIT ${a.to!==null?a.to-(a.from||0):1e9}`,f),a.from!==null&&b(` OFFSET ${a.from}`,f);return f}function Yr(e,t){if(typeof e=="object"){let n="";return e.database!=null&&(n+=t(e.database)+"."),e.schema!=null&&(n+=t(e.schema)+"."),n+=t(e.table),n}else return t(e)}function b(e,t){const n=t[0];n[n.length-1]+=e}function ft({column:e,direction:t},n,r){b(`${r(e)} ${t.toUpperCase()}`,n)}function Hr({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(t.length===1||e==="v"||e==="nv")switch(M(t[0],n,r),e){case"n":case"nv":b(" IS NULL",n);return;case"nn":case"v":b(" IS NOT NULL",n);return;default:throw new Error("Invalid filter operation")}if(t.length===2&&!["in","nin"].includes(e))if(["c","nc"].includes(e)){switch(M(t[0],n,r),e){case"c":b(" LIKE ",n);break;case"nc":b(" NOT LIKE ",n);break}M(Zr(t[1]),n,r);return}else{switch(M(t[0],n,r),e){case"eq":b(" = ",n);break;case"ne":b(" <> ",n);break;case"gt":b(" > ",n);break;case"lt":b(" < ",n);break;case"gte":b(" >= ",n);break;case"lte":b(" <= ",n);break;default:throw new Error("Invalid filter operation")}M(t[1],n,r);return}switch(M(t[0],n,r),e){case"in":b(" IN (",n);break;case"nin":b(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}Gr(t.slice(1),n),b(")",n)}function M(e,t,n){e.type==="column"?b(n(e.value),t):(t.push(e.value),t[0].push(""))}function Gr(e,t){let n=!0;for(const r of e)n?n=!1:b(",",t),t.push(r.value),t[0].push("")}function Zr(e){return{...e,value:`%${e.value}%`}}function zt(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))}function Qr(e,t){return zt(e,t)||(e<t?-1:e>t?1:0)}function Jr(e,t){return zt(e,t)||(e>t?-1:e<t?1:0)}const Kr=e=>typeof e=="number"&&!Number.isNaN(e),Xr=e=>Number.isInteger(e)&&!Number.isNaN(e),ei=e=>typeof e=="string",ti=e=>typeof e=="boolean",ni=e=>typeof e=="bigint",ri=e=>e instanceof Date&&!isNaN(e),ii=e=>e instanceof ArrayBuffer,oi=e=>Array.isArray(e),si=e=>typeof e=="object"&&e!==null,ai=e=>e!=null;function dt(e){switch(e){case"string":return ei;case"bigint":return ni;case"boolean":return ti;case"number":return Kr;case"integer":return Xr;case"date":return ri;case"buffer":return ii;case"array":return oi;case"object":return si;case"other":default:return ai}}const Wt=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function ci(e,t){switch(t){case"string":return typeof e=="string"||e==null?e:String(e);case"boolean":if(typeof e=="string"){const n=e.trim().toLowerCase();return n==="true"?!0:n==="false"?!1:null}return typeof e=="boolean"||e==null?e:!!e;case"bigint":return typeof e=="bigint"||e==null?e:Number.isInteger(typeof e=="string"&&!e.trim()?NaN:+e)?BigInt(e):void 0;case"integer":case"number":return typeof e=="number"?e:e==null||typeof e=="string"&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||e==null)return e;if(typeof e=="number")return new Date(e);const n=String(e).trim();return typeof e=="string"&&!n?null:new Date(Wt.test(n)?n:NaN)}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function li(e){const{columns:t}=e;let{schema:n}=e;return Mt(n)?{schema:n,inferred:!1}:(n=Yt(e,Pt(t)?t:void 0),{schema:n,inferred:!0})}function pt(e,t){const n=e;let{schema:r,inferred:i}=li(e);const s=new Map(r.map(({name:o,type:a})=>[o,a]));if(t.types){for(const{name:o,type:a}of t.types){s.set(o,a),r===n.schema&&(r=r.slice());const u=r.findIndex(c=>c.name===o);u>-1&&(r[u]={...r[u],type:a})}e=e.map(o=>Ie(o,s,r))}else i&&(e=e.map(o=>Ie(o,s,r)));return{source:e,schema:r}}function mt(e,t){if(!t.names)return e;const n=new Map(t.names.map(r=>[r.column,r]));return e.map(r=>Object.fromEntries(Object.keys(r).map(i=>{const s=n.get(i);return[(s==null?void 0:s.name)??i,r[i]]})))}function ui(e,t){const n=new Map,r=e,i=pt(e,t);e=i.source;let s=i.schema;if(t.derive){const c=[];t.derive.map(({name:l,value:d})=>{let p=[];mt(e,t).map((h,m)=>{let E;try{E=d(h)}catch(T){p.push({index:m,error:T}),E=void 0}c[m]?c[m]={...c[m],[l]:E}:c.push({[l]:E})}),p.length&&n.set(l,p)});const f=pt(c,t);e=e.map((l,d)=>({...l,...f.source[d]})),s=[...s,...f.schema]}for(const{type:c,operands:f}of t.filter){const[{value:l}]=f,d=f.slice(1).map(({value:p})=>p);switch(c){case"v":{const[p]=d,h=dt(p);e=e.filter(m=>h(m[l]));break}case"nv":{const[p]=d,h=dt(p);e=e.filter(m=>!h(m[l]));break}case"eq":{const[p]=d;if(p instanceof Date){const h=+p;e=e.filter(m=>+m[l]===h)}else e=e.filter(h=>h[l]===p);break}case"ne":{const[p]=d;e=e.filter(h=>h[l]!==p);break}case"c":{const[p]=d;e=e.filter(h=>typeof h[l]=="string"&&h[l].includes(p));break}case"nc":{const[p]=d;e=e.filter(h=>typeof h[l]=="string"&&!h[l].includes(p));break}case"in":{const p=new Set(d);e=e.filter(h=>p.has(h[l]));break}case"nin":{const p=new Set(d);e=e.filter(h=>!p.has(h[l]));break}case"n":{e=e.filter(p=>p[l]==null);break}case"nn":{e=e.filter(p=>p[l]!=null);break}case"lt":{const[p]=d;e=e.filter(h=>h[l]<p);break}case"lte":{const[p]=d;e=e.filter(h=>h[l]<=p);break}case"gt":{const[p]=d;e=e.filter(h=>h[l]>p);break}case"gte":{const[p]=d;e=e.filter(h=>h[l]>=p);break}default:throw new Error(`unknown filter type: ${c}`)}}for(const{column:c,direction:f}of Ar(t.sort)){const l=f==="desc"?Jr:Qr;e===r&&(e=e.slice()),e.sort((d,p)=>l(d[c],p[c]))}let{from:o,to:a}=t.slice;o=o==null?0:Math.max(0,o),a=a==null?1/0:Math.max(0,a),(o>0||a<1/0)&&(e=e.slice(Math.max(0,o),Math.max(0,a)));let u=s.slice();if(t.select.columns){if(s){const c=new Map(s.map(f=>[f.name,f]));s=t.select.columns.map(f=>c.get(f))}e=e.map(c=>Object.fromEntries(t.select.columns.map(f=>[f,c[f]])))}if(t.names){const c=new Map(t.names.map(f=>[f.column,f]));s&&(s=s.map(f=>{const l=c.get(f.name);return{...f,...l?{name:l.name}:null}})),u&&(u=u.map(f=>{const l=c.get(f.name);return{...f,...l?{name:l.name}:null}})),e=mt(e,t)}return e!==r&&s&&(e.schema=s),e.fullSchema=u,e.errors=n,e}function Ie(e,t,n){const r={};for(const i of n){const s=t.get(i.name),o=e[i.name];r[i.name]=s==="raw"?o:ci(o,s)}return r}function fi(){return{boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0}}const di=["boolean","integer","number","date","bigint","array","object","buffer"];function pi(e){const t=new Set;for(const n of e)if(n)for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.add(r);return Array.from(t)}function Yt(e,t=pi(e)){const n=[],i=e.slice(0,100);for(const s of t){const o=fi();for(const c of i){let f=c[s];if(f==null)continue;const l=typeof f;if(l!=="string")++o.defined,Array.isArray(f)?++o.array:f instanceof Date?++o.date:f instanceof ArrayBuffer?++o.buffer:l==="number"?(++o.number,Number.isInteger(f)&&++o.integer):l in o&&++o[l];else{if(f=f.trim(),!f)continue;++o.defined,++o.string,/^(true|false)$/i.test(f)?++o.boolean:f&&!isNaN(f)?(++o.number,Number.isInteger(+f)&&++o.integer):Wt.test(f)&&++o.date}}const a=Math.max(1,o.defined*.9),u=Nr(di,c=>o[c]>=a?o[c]:NaN)??(o.string>=a?"string":"other");n.push({name:s,type:u,inferred:u})}return n}class mi{constructor(t){Object.defineProperties(this,{_:{value:t},sheetNames:{value:t.worksheets.map(n=>n.name),enumerable:!0}})}sheet(t,n){const r=typeof t=="number"?this.sheetNames[t]:this.sheetNames.includes(t+="")?t:null;if(r==null)throw new Error(`Sheet not found: ${t}`);const i=this._.getWorksheet(r);return hi(i,n)}}function hi(e,{range:t,headers:n}={}){let[[r,i],[s,o]]=bi(t,e);const a=n?e._rows[i++]:null;let u=new Set(["#"]);for(let f=r;f<=s;f++){const l=a?ht(a.findCell(f+1)):null;let d=l&&l+""||wi(f);for(;u.has(d);)d+="_";u.add(d)}u=new Array(r).concat(Array.from(u));const c=new Array(o-i+1);for(let f=i;f<=o;f++){const l=c[f-i]=Object.create(null,{"#":{value:f+1}}),d=e.getRow(f+1);if(d.hasValues)for(let p=r;p<=s;p++){const h=ht(d.findCell(p+1));h!=null&&(l[u[p+1]]=h)}}return c.columns=u.filter(()=>!0),c}function ht(e){if(!e)return;const{value:t}=e;if(t&&typeof t=="object"&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return bt(t);if(t.text){let{text:n}=t;return n.richText&&(n=bt(n)),t.hyperlink&&t.hyperlink!==n?`${t.hyperlink} ${n}`:n}return t}return t}function bt(e){return e.richText.map(t=>t.text).join("")}function bi(e=":",{columnCount:t,rowCount:n}){if(e+="",!e.match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,i=0],[s=t-1,o=n-1]]=e.split(":").map(yi);return[[r,i],[s,o]]}function wi(e){let t="";e++;do t=String.fromCharCode(64+(e%26||26))+t;while(e=Math.floor((e-1)/26));return t}function yi(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let i=0;i<t.length;i++)r+=Math.pow(26,t.length-i-1)*(t.charCodeAt(i)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function x(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}function _i(e,t){const n=new Map(t.map(({name:r,type:i})=>[r,i]));return Object.assign(e.map(r=>Ie(r,n,t)),{schema:t})}async function wt(e,t,{array:n=!1,typed:r=!1}={}){const i=await e.text(),s=t==="	"?n?Zn:Gn:n?Hn:Yn;if(r==="auto"&&!n){const o=s(i);return _i(o,Yt(o,o.columns))}return s(i,r&&Qn)}class Ve{constructor(t,n){Object.defineProperty(this,"name",{value:t,enumerable:!0}),n!==void 0&&Object.defineProperty(this,"mimeType",{value:n+"",enumerable:!0})}async blob(){return(await x(this)).blob()}async arrayBuffer(){return(await x(this)).arrayBuffer()}async text(){return(await x(this)).text()}async json(){return(await x(this)).json()}async stream(){return(await x(this)).body}async csv(t){return wt(this,",",t)}async tsv(t){return wt(this,"	",t)}async image(t){const n=await this.url();return new Promise((r,i)=>{const s=new Image;new URL(n,document.baseURI).origin!==new URL(location).origin&&(s.crossOrigin="anonymous"),Object.assign(s,t),s.onload=()=>r(s),s.onerror=()=>i(new Error(`Unable to load file: ${this.name}`)),s.src=n})}async arrow({version:t=4}={}){switch(t){case 4:{const[n,r]=await Promise.all([L(qe.resolve()),x(this)]);return n.Table.from(r)}case 9:{const[n,r]=await Promise.all([ce(()=>import(`${k}${lr.resolve()}`),[],import.meta.url),x(this)]);return n.tableFromIPC(r)}case 11:{const[n,r]=await Promise.all([ce(()=>import(`${k}${kt.resolve()}`),[],import.meta.url),x(this)]);return n.tableFromIPC(r)}default:throw new Error(`unsupported arrow version: ${t}`)}}async sqlite(){return Q.open(x(this))}async zip(){const[t,n]=await Promise.all([L(ir.resolve()),this.arrayBuffer()]);return new Ei(await t.loadAsync(n))}async xml(t="application/xml"){return new DOMParser().parseFromString(await this.text(),t)}async html(){return this.xml("text/html")}async xlsx(){const[t,n]=await Promise.all([L(dr.resolve()),this.arrayBuffer()]);return new mi(await new t.Workbook().xlsx.load(n))}}class y extends Ve{constructor(t,n,r){super(n,r),Object.defineProperty(this,"_url",{value:t})}async url(){return await this._url+""}}function gi(e){throw new Error(`File not found: ${e}`)}function vi(e){return Object.assign(t=>{const n=e(t+="");if(n==null)throw new Error(`File not found: ${t}`);if(typeof n=="object"&&"url"in n){const{url:r,mimeType:i}=n;return new y(r,t,i)}return new y(n,t)},{prototype:y.prototype})}class Ei{constructor(t){Object.defineProperty(this,"_",{value:t}),this.filenames=Object.keys(t.files).filter(n=>!t.files[n].dir)}file(t){const n=this._.file(t+="");if(!n||n.dir)throw new Error(`file not found: ${t}`);return new Ci(n)}}class Ci extends Ve{constructor(t){super(t.name),Object.defineProperty(this,"_",{value:t}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}function Ti(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function xi(e,t,n){n==null&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var i=r.getContext("2d");return i.scale(n,n),i}function Ni(e,t="untitled",n="Save"){const r=document.createElement("a"),i=r.appendChild(document.createElement("button"));i.textContent=n,r.download=t;async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),i.textContent=n,i.disabled=!1}return r.onclick=async o=>{if(i.disabled=!0,r.href)return s();i.textContent="Saving…";try{const a=await(typeof e=="function"?e():e);i.textContent="Download",r.href=URL.createObjectURL(a)}catch{i.textContent=n}if(o.eventPhase)return s();i.disabled=!1},r}var re={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ai(e,t){var n=e+="",r=n.indexOf(":"),i;r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1));var s=re.hasOwnProperty(n)?document.createElementNS(re[n],e):document.createElement(e);if(t)for(var o in t)n=o,r=n.indexOf(":"),i=t[o],r>=0&&(n=o.slice(0,r))!=="xmlns"&&(o=o.slice(r+1)),re.hasOwnProperty(n)?s.setAttributeNS(re[n],o,i):s.setAttribute(o,i);return s}function Si(e){var t=document.createElement("input");return e!=null&&(t.type=e),t}function $i(e,t,n){arguments.length===1&&(t=e,e=null);var r=document.createElement("input");return r.min=e=e==null?0:+e,r.max=t=t==null?1:+t,r.step=n==null?"any":n=+n,r.type="range",r}function Oi(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,function(n){var r=document.createElement("option");r.value=r.textContent=n,t.appendChild(r)}),t}function qi(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n}function ki(e){return document.createTextNode(e)}var Li=0;function Ht(e){return new Gt("O-"+(e==null?"":e+"-")+ ++Li)}function Gt(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Gt.prototype.toString=function(){return"url("+this.href+")"};const Ii=Object.freeze(Object.defineProperty({__proto__:null,canvas:Ti,context2d:xi,download:Ni,element:Ai,input:Si,range:$i,select:Oi,svg:qi,text:ki,uid:Ht},Symbol.toStringTag,{value:"Module"}));function Ri(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function Mi(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)})}function Pi(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)})}const ji=Object.freeze(Object.defineProperty({__proto__:null,buffer:Ri,text:Mi,url:Pi},Symbol.toStringTag,{value:"Module"}));function ze(){return this}function Zt(e,t){let n=!1;if(typeof t!="function")throw new Error("dispose is not a function");return{[Symbol.iterator]:ze,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function*Di(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)}function we(e){let t=!1,n,r;const i=e(s);if(i!=null&&typeof i!="function")throw new Error(typeof i.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function s(a){return r?(r(a),r=null):t=!0,n=a}function o(){return{done:!1,value:t?(t=!1,Promise.resolve(n)):new Promise(a=>r=a)}}return{[Symbol.iterator]:ze,throw:()=>({done:!0}),return:()=>(i!=null&&i(),{done:!0}),next:o}}function Ui(e){return we(function(t){var n=Bi(e),r=yt(e);function i(){t(yt(e))}return e.addEventListener(n,i),r!==void 0&&t(r),function(){e.removeEventListener(n,i)}})}function yt(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,t=>t.value);default:return e.value}}function Bi(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}function*Fi(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)}function Vi(e){let t;const n=[],r=e(i);if(r!=null&&typeof r!="function")throw new Error(typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function i(o){return n.push(o),t&&(t(n.shift()),t=null),o}function s(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise(o=>t=o)}}return{[Symbol.iterator]:ze,throw:()=>({done:!0}),return:()=>(r!=null&&r(),{done:!0}),next:s}}function*zi(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0;++r<i;)yield e+r*n}function Wi(e,t){if(!(!isFinite(t=+t)||t<0||t!==t|0)){for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value}}function Yi(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Zt(n,()=>{n.terminate(),URL.revokeObjectURL(t)})}const Hi=Object.freeze(Object.defineProperty({__proto__:null,disposable:Zt,filter:Di,input:Ui,map:Fi,observe:we,queue:Vi,range:zi,valueAt:Wi,worker:Yi},Symbol.toStringTag,{value:"Module"}));function We(e,t){return function(n){var r=n[0],i=[],s,o=null,a,u,c,f,l,d,p,h=-1;for(f=1,l=arguments.length;f<l;++f){if(s=arguments[f],s instanceof Node)i[++h]=s,r+="<!--o:"+h+"-->";else if(Array.isArray(s)){for(d=0,p=s.length;d<p;++d)a=s[d],a instanceof Node?(o===null&&(i[++h]=o=document.createDocumentFragment(),r+="<!--o:"+h+"-->"),o.appendChild(a)):(o=null,r+=a);o=null}else r+=s;r+=n[f]}if(o=e(r),++h>0){for(u=new Array(h),c=document.createTreeWalker(o,NodeFilter.SHOW_COMMENT,null,!1);c.nextNode();)a=c.currentNode,/^o:/.test(a.nodeValue)&&(u[+a.nodeValue.slice(2)]=a);for(f=0;f<h;++f)(a=u[f])&&a.parentNode.replaceChild(i[f],a)}return o.childNodes.length===1?o.removeChild(o.firstChild):o.nodeType===11?((a=t()).appendChild(o),a):o}}const Gi=We(function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)},function(){return document.createElement("span")});async function Zi(e){const t=await e(ot.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(ot.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}function Qi(e){return e(or.resolve()).then(function(t){return We(function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var i=r.querySelectorAll("pre code[class]");return i.length>0&&e(Ce.resolve()).then(function(s){i.forEach(function(o){function a(){s.highlightBlock(o),o.parentNode.classList.add("observablehq--md-pre")}s.getLanguage(o.className)?a():e(Ce.resolve("async-languages/index.js")).then(u=>{if(u.has(o.className))return e(Ce.resolve("async-languages/"+u.get(o.className))).then(c=>{s.registerLanguage(o.className,c)})}).then(a,a)})}),r},function(){return document.createElement("div")})})}async function Ji(e){const t=await e(pr.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const r=document.createElement("div");return r.innerHTML=t.render(Ht().id,String.raw.apply(String,arguments)),r.removeChild(r.firstChild)}}function Ki(e){let t;Object.defineProperties(this,{generator:{value:we(n=>void(t=n))},value:{get:()=>e,set:n=>t(e=n)}}),e!==void 0&&t(e)}function*Xi(){for(;;)yield Date.now()}function eo(e,t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}var Re=new Map;function to(e,t){var n=new Promise(function(r){Re.delete(t);var i=t-e;if(!(i>0))throw new Error("invalid time");if(i>2147483647)throw new Error("too long to wait");setTimeout(r,i)});return Re.set(t,n),n}function Qt(e,t){var n;return(n=Re.get(e=+e))?n.then(()=>t):(n=Date.now())>=e?Promise.resolve(t):to(n,e).then(()=>t)}function no(e,t){return Qt(Math.ceil((Date.now()+1)/e)*e,t)}const ro=Object.freeze(Object.defineProperty({__proto__:null,delay:eo,tick:no,when:Qt},Symbol.toStringTag,{value:"Module"}));function io(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}const oo=We(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t},function(){return document.createElementNS("http://www.w3.org/2000/svg","g")});var so=String.raw;function ao(e){return new Promise(function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)})}function co(e){return Promise.all([e(rt.resolve()),e.resolve(rt.resolve("dist/katex.min.css")).then(ao)]).then(function(t){var n=t[0],r=i();function i(s){return function(){var o=document.createElement("div");return n.render(so.apply(String,arguments),o,s),o.removeChild(o.firstChild)}}return r.options=i,r.block=i({displayMode:!0}),r})}async function lo(e){const[t,n,r]=await Promise.all([sr,ar,cr].map(i=>e(i.resolve())));return r.register(t,n)}function uo(){return we(function(e){var t=e(document.body.clientWidth);function n(){var r=document.body.clientWidth;r!==t&&e(t=r)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}})}const fo=Object.assign(Object.defineProperties(function(t){const n=Cr(t);Object.defineProperties(this,po({FileAttachment:()=>gi,Mutable:()=>Ki,now:Xi,width:uo,dot:()=>n(tr.resolve()),htl:()=>n(rr.resolve()),html:()=>Gi,md:()=>Qi(n),svg:()=>oo,tex:()=>co(n),_:()=>n(nr.resolve()),aq:()=>n.alias({"apache-arrow":qe.resolve()})(ur.resolve()),Arrow:()=>n(qe.resolve()),d3:()=>n(Kn.resolve()),DuckDBClient:()=>J,Inputs:()=>n(Xn.resolve()).then(r=>({...r,file:r.fileOf(Ve)})),L:()=>Zi(n),mermaid:()=>Ji(n),Plot:()=>n(er.resolve()),__query:()=>Ft,require:()=>n,resolve:()=>io,SQLite:()=>Rt(n),SQLiteDatabaseClient:()=>Q,topojson:()=>n(fr.resolve()),vl:()=>lo(n),aapl:()=>new y("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new y("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new y("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new y("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new y("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new y("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new y("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new y("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new y("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new y("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),weather:()=>new y("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:Ii,Files:ji,Generators:Hi,Promises:ro}))},{resolve:{get:()=>L.resolve,enumerable:!0,configurable:!0},require:{get:()=>L,set:Er,enumerable:!0,configurable:!0}}),{resolveFrom:Lt,requireFrom:he});function po(e){return Object.fromEntries(Object.entries(e).map(mo))}function mo([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}class S extends Error{constructor(t,n){super(t),this.input=n}}S.prototype.name="RuntimeError";function ho(e){return e&&typeof e.next=="function"&&typeof e.return=="function"}function Me(e){return()=>e}function fe(e){return e}function bo(e){return()=>{throw e}}const wo=Array.prototype,yo=wo.map;function O(){}const Ye=1,K=2,ie=3,H=Symbol("no-observer");function I(e,t,n,r){n||(n=H),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:He,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:O,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==H,writable:!0},_rejector:{value:Eo(this)},_shadow:{value:_o(t,r)},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}Object.defineProperties(I.prototype,{_pending:{value:Ao,writable:!0,configurable:!0},_fulfilled:{value:So,writable:!0,configurable:!0},_rejected:{value:$o,writable:!0,configurable:!0},_resolve:{value:To,writable:!0,configurable:!0},define:{value:Co,writable:!0,configurable:!0},delete:{value:No,writable:!0,configurable:!0},import:{value:xo,writable:!0,configurable:!0}});function _o(e,t){return t!=null&&t.shadow?new Map(Object.entries(t.shadow).map(([n,r])=>[n,new I(K,e).define([],r)])):null}function go(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function vo(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function He(){throw He}function $(){throw $}function Eo(e){return t=>{throw t===$?t:t===He?new S(`${e._name} is not defined`,e._name):t instanceof Error&&t.message?new S(t.message,e._name):new S(`${e._name} could not be resolved`,e._name)}}function _t(e){return()=>{throw new S(`${e} is defined more than once`)}}function Co(e,t,n){switch(arguments.length){case 1:{n=e,e=t=null;break}case 2:{n=t,typeof e=="string"?t=null:(t=e,e=null);break}}return Ge.call(this,e==null?null:String(e),t==null?[]:yo.call(t,this._resolve,this),typeof n=="function"?n:Me(n))}function To(e){var t;return((t=this._shadow)==null?void 0:t.get(e))??this._module._resolve(e)}function Ge(e,t,n){const r=this._module._scope,i=this._module._runtime;if(this._inputs.forEach(vo,this),t.forEach(go,this),this._inputs=t,this._definition=n,this._value=void 0,n===O?i._variables.delete(this):i._variables.add(this),e!==this._name||r.get(e)!==this){let s,o;if(this._name)if(this._outputs.size)r.delete(this._name),o=this._module._resolve(this._name),o._outputs=this._outputs,this._outputs=new Set,o._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(this)]=o},this),o._outputs.forEach(i._updates.add,i._updates),i._dirty.add(o).add(this),r.set(this._name,o);else if((o=r.get(this._name))===this)r.delete(this._name);else if(o._type===ie)o._duplicates.delete(this),this._duplicate=void 0,o._duplicates.size===1&&(o=o._duplicates.keys().next().value,s=r.get(this._name),o._outputs=s._outputs,s._outputs=new Set,o._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(s)]=o}),o._definition=o._duplicate,o._duplicate=void 0,i._dirty.add(s).add(o),i._updates.add(o),r.set(this._name,o));else throw new Error;if(this._outputs.size)throw new Error;e&&((o=r.get(e))?o._type===ie?(this._definition=_t(e),this._duplicate=n,o._duplicates.add(this)):o._type===K?(this._outputs=o._outputs,o._outputs=new Set,this._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(o)]=this},this),i._dirty.add(o).add(this),r.set(e,this)):(o._duplicate=o._definition,this._duplicate=n,s=new I(ie,this._module),s._name=e,s._definition=this._definition=o._definition=_t(e),s._outputs=o._outputs,o._outputs=new Set,s._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(o)]=s}),s._duplicates=new Set([this,o]),i._dirty.add(o).add(s),i._updates.add(o).add(s),r.set(e,s)):r.set(e,this)),this._name=e}return this._version>0&&++this._version,i._updates.add(this),i._compute(),this}function xo(e,t,n){return arguments.length<3&&(n=t,t=e),Ge.call(this,String(t),[n._resolve(String(e))],fe)}function No(){return Ge.call(this,null,[],O)}function Ao(){this._observer.pending&&this._observer.pending()}function So(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)}function $o(e){this._observer.rejected&&this._observer.rejected(e,this._name)}const Jt=Symbol("variable"),Kt=Symbol("invalidation"),Xt=Symbol("visibility");function de(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",Jt],["invalidation",Kt],["visibility",Xt],...t])},_source:{value:null,writable:!0}})}Object.defineProperties(de.prototype,{_resolve:{value:Mo,writable:!0,configurable:!0},redefine:{value:Oo,writable:!0,configurable:!0},define:{value:qo,writable:!0,configurable:!0},derive:{value:Ro,writable:!0,configurable:!0},import:{value:ko,writable:!0,configurable:!0},value:{value:Io,writable:!0,configurable:!0},variable:{value:Lo,writable:!0,configurable:!0},builtin:{value:Po,writable:!0,configurable:!0}});function Oo(e){const t=this._scope.get(e);if(!t)throw new S(`${e} is not defined`);if(t._type===ie)throw new S(`${e} is defined more than once`);return t.define.apply(t,arguments)}function qo(){const e=new I(Ye,this);return e.define.apply(e,arguments)}function ko(){const e=new I(Ye,this);return e.import.apply(e,arguments)}function Lo(e,t){return new I(Ye,this,e,t)}async function Io(e){let t=this._scope.get(e);if(!t)throw new S(`${e} is not defined`);if(t._observer===H){t=this.variable(!0).define([e],fe);try{return await Pe(this._runtime,t)}finally{t.delete()}}else return Pe(this._runtime,t)}async function Pe(e,t){await e._compute();try{return await t._promise}catch(n){if(n===$)return Pe(e,t);throw n}}function Ro(e,t){const n=new Map,r=new Set,i=[];function s(a){let u=n.get(a);return u||(u=new de(a._runtime,a._builtins),u._source=a,n.set(a,u),i.push([u,a]),r.add(a),u)}const o=s(this);for(const a of e){const{alias:u,name:c}=typeof a=="object"?a:{name:a};o.import(c,u??c,t)}for(const a of r)for(const[u,c]of a._scope)if(c._definition===fe){if(a===this&&o._scope.has(u))continue;const f=c._inputs[0]._module;f._source&&s(f)}for(const[a,u]of i)for(const[c,f]of u._scope){const l=a._scope.get(c);if(!(l&&l._type!==K))if(f._definition===fe){const d=f._inputs[0],p=d._module;a.import(d._name,c,n.get(p)||p)}else a.define(c,f._inputs.map(jo),f._definition)}return o}function Mo(e){let t=this._scope.get(e),n;if(!t)if(t=new I(K,this),this._builtins.has(e))t.define(e,Me(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))t.import(e,this._runtime._builtin);else{try{n=this._runtime._global(e)}catch(r){return t.define(e,bo(r))}n===void 0?this._scope.set(t._name=e,t):t.define(e,Me(n))}return t}function Po(e,t){this._builtins.set(e,t)}function jo(e){return e._name}const Do=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:e=>setTimeout(e,0);function en(e=new fo,t=rs){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const r in e)new I(K,n).define(r,[],e[r])}Object.defineProperties(en.prototype,{_precompute:{value:Fo,writable:!0,configurable:!0},_compute:{value:Vo,writable:!0,configurable:!0},_computeSoon:{value:zo,writable:!0,configurable:!0},_computeNow:{value:Wo,writable:!0,configurable:!0},dispose:{value:Uo,writable:!0,configurable:!0},module:{value:Bo,writable:!0,configurable:!0},fileAttachments:{value:vi,writable:!0,configurable:!0}});function Uo(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(e=>{e._invalidate(),e._version=NaN})}function Bo(e,t=O){let n;if(e===void 0)return(n=this._init)?(this._init=null,n):new de(this);if(n=this._modules.get(e),n)return n;this._init=n=new de(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n}function Fo(e){this._precomputes.push(e),this._compute()}function Vo(){return this._computing||(this._computing=this._computeSoon())}function zo(){return new Promise(Do).then(()=>this._disposed?void 0:this._computeNow())}async function Wo(){let e=[],t,n,r=this._precomputes;if(r.length){this._precomputes=[];for(const s of r)s();await Yo(3)}t=new Set(this._dirty),t.forEach(function(s){s._inputs.forEach(t.add,t);const o=ns(s);o>s._reachable?this._updates.add(s):o<s._reachable&&s._invalidate(),s._reachable=o},this),t=new Set(this._updates),t.forEach(function(s){s._reachable?(s._indegree=0,s._outputs.forEach(t.add,t)):(s._indegree=NaN,t.delete(s))}),this._computing=null,this._updates.clear(),this._dirty.clear(),t.forEach(function(s){s._outputs.forEach(Go)});do{for(t.forEach(function(s){s._indegree===0&&e.push(s)});n=e.pop();)Ko(n),n._outputs.forEach(i),t.delete(n);t.forEach(function(s){Ho(s)&&(es(s,new S("circular definition")),s._outputs.forEach(Zo),t.delete(s))})}while(t.size);function i(s){--s._indegree===0&&e.push(s)}}function Yo(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then(()=>{});return t}function Ho(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function Go(e){++e._indegree}function Zo(e){--e._indegree}function Qo(e){return e._promise.catch(e._rejector)}function Ae(e){return new Promise(function(t){e._invalidate=t})}function Jo(e,t){let n=typeof IntersectionObserver=="function"&&t._observer&&t._observer._node,r=!n,i=O,s=O,o,a;return n&&(a=new IntersectionObserver(([u])=>(r=u.isIntersecting)&&(o=null,i())),a.observe(n),e.then(()=>(a.disconnect(),a=null,s()))),function(u){return r?Promise.resolve(u):a?(o||(o=new Promise((c,f)=>(i=c,s=f))),o.then(()=>u)):Promise.reject()}}function Ko(e){e._invalidate(),e._invalidate=O,e._pending();const t=e._value,n=++e._version;let r=null;const i=e._promise=(e._inputs.length?Promise.all(e._inputs.map(Qo)).then(s):new Promise(a=>a(e._definition.call(t)))).then(o);function s(a){if(e._version!==n)throw $;for(let u=0,c=a.length;u<c;++u)switch(a[u]){case Kt:{a[u]=r=Ae(e);break}case Xt:{r||(r=Ae(e)),a[u]=Jo(r,e);break}case Jt:{a[u]=e;break}}return e._definition.apply(t,a)}function o(a){if(e._version!==n)throw $;return ho(a)?((r||Ae(e)).then(ts(a)),Xo(e,n,a)):a}i.then(a=>{e._value=a,e._fulfilled(a)},a=>{a!==$&&(e._value=void 0,e._rejected(a))})}function Xo(e,t,n){const r=e._module._runtime;let i;function s(u){return new Promise(c=>c(n.next(i))).then(({done:c,value:f})=>c?void 0:Promise.resolve(f).then(u))}function o(){const u=s(c=>{if(e._version!==t)throw $;return i=c,a(c,u).then(()=>r._precompute(o)),e._fulfilled(c),c});u.catch(c=>{c===$||e._version!==t||(a(void 0,u),e._rejected(c))})}function a(u,c){return e._value=u,e._promise=c,e._outputs.forEach(r._updates.add,r._updates),r._compute()}return s(u=>{if(e._version!==t)throw $;return i=u,r._precompute(o),u})}function es(e,t){e._invalidate(),e._invalidate=O,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(O),e._value=void 0,e._rejected(t)}function ts(e){return function(){e.return()}}function ns(e){if(e._observer!==H)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==H)return!0;n._outputs.forEach(t.add,t)}return!1}function rs(e){return globalThis[e]}const pe=parseInt(location.hash.substring(1));document.body.classList.add("step-"+pe);function is(e,t,n){const r=window.innerWidth,i=window.innerHeight,s=e.scaleOrdinal(e.schemeCategory10),o=t.links.map(m=>({...m})),a=t.nodes.map(m=>({...m})),u=e.forceSimulation(a).force("link",e.forceLink(o).id(m=>m.id)).force("charge",e.forceManyBody().strength(-100)).force("x",e.forceX()).force("y",e.forceY()),c=e.create("svg").attr("width",r).attr("height",i).attr("viewBox",[-r/2,-i/2,r,i]).attr("style","max-width: 100%; height: auto;"),f=c.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(o).join("line").attr("stroke-width",2),l=c.append("g").attr("stroke","#fff").attr("stroke-width",1.5).selectAll("g.node").data(a).join("g").attr("class","node");l.append("rect").attr("width",30).attr("height",30).attr("x",-15).attr("class","isolate").attr("y",-15).attr("fill",m=>"white").attr("stroke",m=>s(m.group)),l.append("circle").attr("r",pe===4?8:5).attr("fill",m=>s(m.group)),l.append("title").text(m=>m.id),l.call(e.drag().on("start",d).on("drag",p).on("end",h)),u.on("tick",()=>{f.attr("x1",m=>m.source.x).attr("y1",m=>m.source.y).attr("x2",m=>m.target.x).attr("y2",m=>m.target.y),l.attr("transform",m=>`translate(${m.x} ${m.y})`)});function d(m){m.active||u.alphaTarget(.3).restart(),m.subject.fx=m.subject.x,m.subject.fy=m.subject.y}function p(m){m.subject.fx=m.x,m.subject.fy=m.y}function h(m){m.active||u.alphaTarget(0),m.subject.fx=null,m.subject.fy=null}return n.then(()=>u.stop()),c.node()}function Se(e){return Math.floor(Math.random()*e)}const os=async()=>{const e=[],t=[];for(let n=0;n<300;n++)e.push({id:n,group:n});if(pe===3)for(let r=0;r<300;r=r+2)t.push({id:r,target:Se(300),source:Se(300)});if(pe===4)for(let r=0;r<300;r++)t.push({id:r,target:r,source:Se(300)});return{nodes:e,links:t}};function ss(e,t){const n=e.module();return n.variable(t("chart")).define("chart",["d3","data","invalidation"],is),n.variable(t("data")).define("data",["FileAttachment"],os),n}const as=new en;as.module(ss,Oe.into(document.body));
